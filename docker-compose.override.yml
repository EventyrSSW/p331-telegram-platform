# docker-compose.override.yml
# Development overrides - automatically applied when running docker-compose up

version: '3.8'

services:
  telegram-game-db:
    # Expose PostgreSQL for direct access during development
    ports:
      - "5432:5432"

  telegram-game-nakama:
    # More verbose logging for development
    entrypoint:
      - "/bin/sh"
      - "-ecx"
      - >
        /nakama/nakama migrate up --database.address p331:p331_local_dev@telegram-game-db:5432/p331 &&
        exec /nakama/nakama --name nakama1 --database.address p331:p331_local_dev@telegram-game-db:5432/p331 --logger.level DEBUG --session.token_expiry_sec 7200 --runtime.js_entrypoint "main.js" --console.username admin --console.password password
    environment:
      - NAKAMA_CONSOLE_USERNAME=admin
      - NAKAMA_CONSOLE_PASSWORD=password
    volumes:
      - ./nakama/modules:/nakama/data/modules:ro   # Custom game logic (hot-reload friendly)
